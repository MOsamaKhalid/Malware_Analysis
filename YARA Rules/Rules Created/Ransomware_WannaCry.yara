rule Ransomware_WannaCry{
    meta:
        description = "YARA Rule for WannaCry Ransomware Detection"
        author = "Muhammad Osama Khalid"
        last_updated = "14 November 2023"
        sha256 = "24d004a104d4d54034dbcffc2a4b19a11f39008a575aa614ea04703480b1022c"
    strings:
        $PE_magic_byte = "MZ"
        $URL = "http://www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com" ascii
        $cmd1 = "attrib +h ." fullword ascii
        $cmd2 = "icacls . /grant Everyone:F /T /C /Q" fullword ascii
        $cmd3 = "cmd.exe /c \"%s\"" fullword ascii
        $cmd4 = "C:\\%s\\qeriuwjhrf" fullword ascii
        $bitcoin_address1 = "115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn"
        $bitcoin_address2 = "12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw"
        $bitcoin_address3 = "13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94"
        $string1 = "WNcry@2ol7" fullword ascii
        $string2 = "inflate 1.1.3 Copyright 1995-1998 Mark Adler" fullword ascii
        $string3 = "unzip 0.15 Copyright 1998 Gilles Vollant" fullword ascii
        $string4 = "Global\\MsWinZonesCacheCounterMutexA" fullword ascii
        $payload = "tasksche.exe" fullword ascii
    condition:
        $PE_magic_byte at 0 and ( $URL or 1 of ($cmd*) or 1 of($bitcoin_address*) or 1 of ($string*) or $payload)
}